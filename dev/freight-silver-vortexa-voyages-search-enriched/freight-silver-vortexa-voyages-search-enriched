from kmt_glue_patterns import process_raw_to_partitioned_silver_with_mappings

process_raw_to_partitioned_silver_with_mappings(
    data_family_name = 'freight',
    source_db_name = 'freight_raw',
    source_table_name = 'vortexa_voyages_search_enriched',
    target_dataset_prefix = 'vortexa/voyages_search_enriched',
    mappings = [
        ("vessel name","string","vessel_name","string"),
    ("imo","string","imo","bigint"),
    ("dwt (t)","string","dwt_t","bigint"),
    ("capacity (cbm)","string","capacity_cbm","bigint"),
    ("vessel class","string","vessel_class","string"),
    ("voyage status","string","voyage_status","string"),
    ("origin","string","origin","string"),
    ("origin terminal","string","origin_terminal","string"),
    ("origin port","string","origin_port","string"),
    ("origin country","string","origin_country","string"),
    ("origin shipping region","string","origin_shipping_region","string"),
    ("destination","string","destination","string"),
    ("destination terminal","string","destination_terminal","string"),
    ("destination port","string","destination_port","string"),
    ("destination country","string","destination_country","string"),
    ("destination shipping region","string","destination_shipping_region","string"),
    ("start date","string","start_date","string"),
    ("end date","string","end_date","string"),
    ("latest product","string","latest_product","string"),
    ("latest product group","string","latest_product_group","string"),
    ("latest product category","string","latest_product_category","string"),
    ("latest product grade","string","latest_product_grade","string"),
    ("quantity (bbl)","string","quantity_bbl","bigint"),
    ("charterer","string","charterer","string"),
    ("effective controller","string","effective_controller","string"),
    ("time charterer","string","time_charterer","string"),
    ("build year","string","build_year","bigint"),
    ("flag","string","flag","string"),
    ("risk rating","string","risk_rating","string"),
    ("scrubbers","string","scrubbers","string"),
    ("coating","string","coating","string"),
    ("tonne-miles","string","tonne_miles","bigint"),
    ("duration (h)","string","duration_h","bigint"),
    ("distance","string","distance","bigint"),
    ("voyage id","string","voyage_id","string"),
    ("previous voyage id","string","previous_voyage_id","string"),
    ("next voyage id","string","next_voyage_id","string"),
    ("first origin","string","first_origin","string"),
    ("first origin terminal","string","first_origin_terminal","string"),
    ("first origin port","string","first_origin_port","string"),
    ("first origin country","string","first_origin_country","string"),
    ("first origin shipping region","string","first_origin_shipping_region","string"),
    ("final destination","string","final_destination","string"),
    ("final destination terminal","string","final_destination_terminal","string"),
    ("final destination port","string","final_destination_port","string"),
    ("final destination country","string","final_destination_country","string"),
    ("final destination shipping region","string","final_destination_shipping_region","string"),
    ("report_date","string","report_date","string")

    ],
    partition_fields = ['report_date']
)
